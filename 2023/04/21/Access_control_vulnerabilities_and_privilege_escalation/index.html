<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="网站：  Access control vulnerabilities and privilege escalation | Web Security Academy All labs | Web Security Academy OWASP_Top_10_2021 Access control security models | Web Security Academy In">
<meta property="og:type" content="article">
<meta property="og:title" content="Access_control_vulnerabilities_and_privilege_escalation">
<meta property="og:url" content="https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/index.html">
<meta property="og:site_name" content="HDFZZF&#39;s BLOG">
<meta property="og:description" content="网站：  Access control vulnerabilities and privilege escalation | Web Security Academy All labs | Web Security Academy OWASP_Top_10_2021 Access control security models | Web Security Academy In">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-04-20T16:00:00.000Z">
<meta property="article:modified_time" content="2023-04-21T08:08:36.121Z">
<meta property="article:author" content="hdfzzf">
<meta property="article:tag" content="burpsuite">
<meta property="article:tag" content="访问控制失效漏洞">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/LOGO.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Access_control_vulnerabilities_and_privilege_escalation</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 6.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="القائمة"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="القائمة"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="الأعلى" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2023/04/22/%E5%A4%8D%E7%8E%B0%EF%BC%9AApache%20Shiro%20%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1957%EF%BC%89/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2023/04/18/OWASP_Top_10_2021/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
    </span>
    <br/>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">1. 什么是访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1.1. 访问控制模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#programmatic-access-control"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1. Programmatic access
control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discretionary-access-controldac"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2. Discretionary access
control（DAC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mandatory-access-controlmac"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3. Mandatory access
control（MAC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#role-based-access-controlrbac"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.1.4. Role-based access
control（RBAC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#attribute-based-access-controlabac"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.1.5. Attribute-based
access control（ABAC）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.2.</span> <span class="toc-text">1.2. 垂直访问控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.3.</span> <span class="toc-text">1.3. 水平访问控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9B%B8%E5%85%B3%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.4.</span> <span class="toc-text">1.4. 上下文相关的访问控制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%B1%E6%95%88%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%BE%8B%E5%AD%90"><span class="toc-number">2.</span> <span class="toc-text">2. 失效的访问控制例子</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">2.1.</span> <span class="toc-text">2.1. 垂直越权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%8F%97%E4%BF%9D%E6%8A%A4%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1. 不受保护的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8F%82%E6%95%B0%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2. 基于参数的访问控制方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E5%8F%B0%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3.
平台配置错误导致访问控制失效</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url-%E5%8C%B9%E9%85%8D%E5%B7%AE%E5%BC%82%E5%AF%BC%E8%87%B4%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4. URL
匹配差异导致的访问控制失效</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83"><span class="toc-number">2.2.</span> <span class="toc-text">2.2. 水平越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83%E5%88%B0%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">2.3.</span> <span class="toc-text">2.3. 从水平越权到垂直越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%B4%E6%8E%A5%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8"><span class="toc-number">2.4.</span> <span class="toc-text">2.4. 不安全的直接对象引用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E5%BC%95%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1%E7%9A%84-idor-%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1. 直接引用数据库对象的 IDOR
漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E5%BC%95%E7%94%A8%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E7%9A%84-idor-%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2. 直接引用静态文件的 IDOR
漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E6%AD%A5%E9%AA%A4%E6%B5%81%E7%A8%8B%E4%B8%AD%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.5.</span> <span class="toc-text">2.5. 多步骤流程中的访问控制漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-referer-%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">2.6.</span> <span class="toc-text">2.6. 基于 Referer 的访问控制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD"><span class="toc-number">3.</span> <span class="toc-text">3. 防御措施</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Access_control_vulnerabilities_and_privilege_escalation
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">hdfzzf</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-04-20T16:00:00.000Z" itemprop="datePublished">2023-04-21</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Web%E5%AE%89%E5%85%A8/">Web安全</a> › <a class="category-link" href="/categories/burpsuite/">burpsuite</a> › <a class="category-link" href="/categories/%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88%E6%BC%8F%E6%B4%9E/">访问控制失效漏洞</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/burpsuite/" rel="tag">burpsuite</a>, <a class="tag-link-link" href="/tags/%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88%E6%BC%8F%E6%B4%9E/" rel="tag">访问控制失效漏洞</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>网站：</p>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control">Access
control vulnerabilities and privilege escalation | Web Security
Academy</a></li>
<li><a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/all-labs#access-control-vulnerabilities">All
labs | Web Security Academy</a></li>
<li><a
href="../../基础知识/OWASP_Top_10_2021.md">OWASP_Top_10_2021</a></li>
<li><a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/security-models">Access
control security models | Web Security Academy</a></li>
<li><a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/idor">Insecure
direct object references (IDOR) | Web Security Academy</a></li>
</ol>
<span id="more"></span>
<h1 id="什么是访问控制">1. 什么是访问控制</h1>
<p>访问控制（或授权）是对谁（或什么）可以执行尝试的操作或访问他们请求的资源的约束的应用。在
Web 应用程序的上下文中，访问控制依赖于身份验证和会话管理：</p>
<ul>
<li>身份验证：用于识别用户，最常见的就是登录表单</li>
<li>会话管理：用于识别 HTTP 请求是哪个用户发送的（HTTP
的无状态型性），最常见的就是登录之后，服务器发送的响应头中的
<code>Set-Cookie</code> 字段；</li>
<li>访问控制：用于确认当前用户是否有权限（被允许）做某个操作，从用户的角度出发，访问控制可以分类为
<ul>
<li><p>垂直访问控制：允许普通用户执行管理员的相关操作；</p>
<figure>
<img
src="https://raw.githubusercontent.com/hdfzzf/Figurebed/main/imgs/20230420084653.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure></li>
<li><p>水平访问控制：允许普通用户 A 执行普通用户 B 的相关操作</p>
<figure>
<img
src="https://raw.githubusercontent.com/hdfzzf/Figurebed/main/imgs/20230420084713.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure></li>
<li><p>上下文相关的访问控制（Context-Dependent Access
Control）：允许用户跳过一些过程，比如下图中，正确的删除用户的过程是
<code>点击 delete -&gt; 来到 /confirm 点击yes -&gt; 删除成功</code>，如果跳过中间的步骤直接删除则打破了
Context-Dependent Access Control；</p>
<figure>
<img
src="https://raw.githubusercontent.com/hdfzzf/Figurebed/main/imgs/20230420084803.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure></li>
</ul></li>
</ul>
<p>Broken Access Control
是一种常见且通常很严重的安全漏洞。访问控制的设计和管理是一个复杂的动态问题，将业务、组织和法律约束应用于技术实现。访问控制设计决策必须由人而不是技术来做出，而且出错的可能性很高。</p>
<h2 id="访问控制模型">1.1. 访问控制模型</h2>
<p>访问控制安全模型是一组独立于技术或实现平台的访问控制规则的正式定义。访问控制安全模型在操作系统、网络、数据库管理系统和后台、应用程序和
web
服务器软件中实现。多年来已经设计了各种访问控制安全模型，以使访问控制策略与业务或组织规则和技术变化相匹配。</p>
<h3 id="programmatic-access-control">1.1.1. Programmatic access
control</h3>
<p>访问控制编程化，用户权限存储矩阵在数据库或类似物中，并且参考该矩阵以编程方式应用访问控制。</p>
<blockquote>
<p>Matrix：矩阵，或者框架</p>
</blockquote>
<p>这种访问控制方法可以包括角色或组或单个用户、流程的集合或工作流，并且可以是高度精细的。</p>
<p>比如 MySQL 数据库：</p>
<figure>
<img
src="https://raw.githubusercontent.com/hdfzzf/Figurebed/main/imgs/20230421150050.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<p>用户的权限也都在 <code>mysql.user</code> 表中。</p>
<h3 id="discretionary-access-controldac">1.1.2. Discretionary access
control（DAC）</h3>
<p>自主访问控制，对资源或功能的访问受到基于用户或指定用户组的限制，资源或功能的所有者能够向用户分配或委派访问权限。</p>
<p>该模型是高度精细的，具有针对单个资源、功能和用户定义的访问权限。因此，模型的设计和管理会变得非常复杂。</p>
<p>比如 Linux
操作系统的用户权限，就是针对单个文件、目录、用户、用户组来设置的。</p>
<h3 id="mandatory-access-controlmac">1.1.3. Mandatory access
control（MAC）</h3>
<p>强制访问控制是一个集中控制的访问控制系统，其中主体对某些对象（文件或其他资源）的访问受到限制。值得注意的是，与
DAC
不同，资源的用户和所有者没有能力委托或修改对其资源的访问权限。该模型通常与基于军事许可的系统相关联。</p>
<h3 id="role-based-access-controlrbac">1.1.4. Role-based access
control（RBAC）</h3>
<p>使用基于角色的访问控制，将定义一些角色（管理员、普通用户等），并为这些角色分配访问权限。然后将用户分配给单个或多个角色。RBAC
提供了优于其他访问控制模型的增强管理，如果设计得当，还可以提供足够的粒度，在复杂的应用程序中提供可管理的访问控制。例如，可以将采购职员定义为具有对采购分类账功能和资源子集的访问权限的角色。当员工离开或加入组织时，访问控制管理被简化为撤销或添加采购人员角色的成员资格。</p>
<p>当有足够多的角色来正确调用访问控制，但又没有太多的角色使模型过于复杂和难以管理时，RBAC
是最有效的。</p>
<h3 id="attribute-based-access-controlabac">1.1.5. Attribute-based
access control（ABAC）</h3>
<p>基于属性的访问控制利用了一组称为“属性”的特征，包括用户属性、环境属性、资源属性。基于这些属性来确定一个功能的访问，而
RBAC（role-based access control）只是基于用户来确定访问控制，ABAC 较于
RBAC 有着更多的变量，所以安全性更高，但实现也更加复杂。</p>
<h2 id="垂直访问控制">1.2. 垂直访问控制</h2>
<p>垂直访问控制是限制对其他类型用户不可用的敏感功能的访问的机制。</p>
<p>通过垂直访问控制，不同类型的用户可以访问不同的应用程序功能。例如，管理员可能能够修改或删除任何用户的帐户，而普通用户无权执行这些操作。垂直访问控制可以是安全模型的更细粒度的实现，旨在实施业务策略，例如职责分离和最小特权。</p>
<h2 id="水平访问控制">1.3. 水平访问控制</h2>
<p>水平访问控制是一种机制，可将对资源的访问限制为专门允许访问这些资源的用户。</p>
<p>通过水平访问控制，不同的用户可以访问同一类型资源的子集。例如，银行应用程序将允许用户查看交易并从他们自己的帐户进行支付，但不能使用任何其他用户的帐户。</p>
<h2 id="上下文相关的访问控制">1.4. 上下文相关的访问控制</h2>
<p>上下文相关的访问控制根据应用程序的状态或用户与应用程序的交互来限制对功能和资源的访问。</p>
<p>上下文相关的访问控制可防止用户以错误的顺序执行操作。例如，零售网站可能会阻止用户在付款后修改购物车的内容。</p>
<h1 id="失效的访问控制例子">2. 失效的访问控制例子</h1>
<p>当用户实际上可以访问某些资源或执行某些他们不应访问的操作时，就会存在访问控制失效漏洞。</p>
<h2 id="垂直越权">2.1. 垂直越权</h2>
<p>如果用户可以访问他们不允许访问的功能，那么这就是垂直权限升级。例如，如果非管理员用户实际上可以获得对管理页面的访问权限，他们可以在其中删除用户帐户，那么这就是垂直权限提升。</p>
<h3 id="不受保护的功能">2.1.1. 不受保护的功能</h3>
<p>在最基本的情况下，垂直越权出现在应用程序未对敏感功能实施任何保护的情况下。例如，管理功能可能从管理员的欢迎页面链接，而不是从用户的欢迎页面链接。但是，用户可能只是能够通过直接浏览到相关的管理
URL 来访问管理功能。</p>
<p>比如管理页面的 URL 为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://insecure-website/admin</span><br></pre></td></tr></table></figure>
<p>只要用户知道了该 URL，实际上任何用户都能够直接访问。</p>
<p>靶场 1：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality">Lab:
Unprotected admin functionality | Web Security Academy</a></p>
<p>关于靶场的 writeup 可以去 <a
href="https://hdfzzf.github.io/2023/04/18/OWASP_Top_10_2021/">OWASP_Top_10_2021</a>
中看。</p>
<p>在某些情况下，敏感功能并没有得到强有力的保护，而是通过给它一个不太可预测的
URL
来隐藏：所谓的安全性。仅隐藏敏感功能并不能提供有效的访问控制，因为用户仍可能以各种方式发现被隐藏的
URL。</p>
<p>例如如下 URL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://insecure-website.com/administrator-panel-yb556</span><br></pre></td></tr></table></figure>
<p>可能会在 JavaScript 代码中暴露，比如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> isAdmin = <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span> (isAdmin) &#123;</span></span><br><span class="line"><span class="javascript">	...</span></span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> adminPanelTag = <span class="built_in">document</span>.createElement(<span class="string">&#x27;a&#x27;</span>);</span></span><br><span class="line"><span class="javascript">	adminPanelTag.setAttribute(<span class="string">&#x27;https://insecure-website.com/administrator-panel-yb556&#x27;</span>);</span></span><br><span class="line"><span class="javascript">	adminPanelTag.innerText = <span class="string">&#x27;Admin panel&#x27;</span>;</span></span><br><span class="line"><span class="javascript">	...</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果用户是管理员用户，此脚本会添加指向用户 UI 的链接。但是，包含 URL
的脚本对所有用户可见，无论其角色如何。</p>
<p>靶场 2：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality-with-unpredictable-url">Lab:
Unprotected admin functionality with unpredictable URL | Web Security
Academy</a></p>
<h3 id="基于参数的访问控制方法">2.1.2. 基于参数的访问控制方法</h3>
<p>一些应用程序在登录时确定用户的访问权限或角色，然后将此信息存储在用户可控的位置，例如隐藏字段、cookie
或预设查询字符串参数。应用程序根据提交的值做出后续的访问控制决策。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://insecure-website.com/login/home.jsp?admin=true</span><br><span class="line">https://insecure-website.com/login/home.jsp?role=1</span><br></pre></td></tr></table></figure>
<p>这种方法从根本上来说是不安全的，因为用户可以简单地修改值并获得对他们未授权的功能的访问权限，例如管理功能。</p>
<p>靶场：</p>
<ol type="1">
<li><a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-user-role-can-be-modified-in-user-profile">Lab:
User role can be modified in user profile | Web Security
Academy</a></li>
<li><a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-user-role-controlled-by-request-parameter">Lab:
User role controlled by request parameter | Web Security
Academy</a></li>
</ol>
<h3 id="平台配置错误导致访问控制失效">2.1.3.
平台配置错误导致访问控制失效</h3>
<p>某些应用程序通过根据用户角色限制对特定 URL 和 HTTP
方法的访问，在平台层实施访问控制。例如，应用程序可能会配置如下规则：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DENY: POST, /admin/deleteUser, managers</span><br></pre></td></tr></table></figure>
<p>此规则拒绝 <code>managers</code> 中的用户使用 POST 方法访问
<code>/admin/deleteUser</code>，这样的规则是可以被绕过的，是不安全的。</p>
<p>一些应用程序框架支持各种非标准的 HTTP 标头，可用于覆盖原始请求中的
URL，例如 X-Original-URL 和
X-Rewrite-URL。如果网站使用严格的前端控制来限制基于 URL
的访问，但应用程序允许通过请求标头覆盖
URL，则可以使用如下请求绕过访问控制：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">X-Original-URL: /admin/deleteUser</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>可以达到与下面的请求一样的效果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST /admin/deleteUser HTTP/1.1</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>靶场 1：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-url-based-access-control-can-be-circumvented">Lab:
URL-based access control can be circumvented | Web Security
Academy</a></p>
<p>另一种攻击可能与请求中使用的 HTTP 方法有关。上面的前端控件基于 URL 和
HTTP 方法限制访问。某些网站在执行操作时容忍备用 HTTP
请求方法。如果攻击者可以使用 GET（或其他）方法对受限 URL
执行操作，则他们可以绕过在平台层实现的访问控制。</p>
<p>比如上面的改成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /admin/deleteUser?param... HTTP/1.1</span><br></pre></td></tr></table></figure>
<p>不过是否可以绕过，需要看后台是如何处理不同方法（后台希望使用
POST，但用户使用了 GET）传参。</p>
<p>靶场 2：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-method-based-access-control-can-be-circumvented">Lab:
Method-based access control can be circumvented | Web Security
Academy</a></p>
<h3 id="url-匹配差异导致的访问控制失效">2.1.4. URL
匹配差异导致的访问控制失效</h3>
<p>在传入请求时，请求的路径必须与规则严格匹配，但也有可能出现匹配不严格的情况。例如，它们可能容忍大小写不一致，因此对
<code>/ADMIN/DELETEUSER</code> 的请求可能仍会映射到相同的
<code>/admin/deleteUser</code>
端点。这本身不是问题，但如果访问控制机制的容忍度较低，它可能会将它们视为两个不同的端点，因此无法强制执行适当的限制。</p>
<p>如果使用 Spring 框架的开发人员启用了 useSuffixPatternMatch
选项，则会出现类似的差异。这允许将具有任意文件扩展名的路径映射到没有文件扩展名的等效端点。换句话说，对
<code>/admin/deleteUser.anything</code> 的请求仍然匹配
<code>/admin/deleteUser</code>。在 Spring 5.3 之前，此选项默认启用。</p>
<p>在其他系统上，您可能会遇到 <code>/admin/deleteUser</code> 和
<code>/admin/deleteUser/</code>
是否被视为不同端点的差异。在这种情况下，您可以简单地通过在路径后面附加一个斜杠来绕过访问控制。</p>
<h2 id="水平越权">2.2. 水平越权</h2>
<p>当一个用户能够访问属于另一个用户的资源，而不是他们自己的那种类型的资源时，就会出现水平权限提升。例如，如果员工理论上只能访问自己的就业和工资记录，但实际却可以访问其他员工的记录，那么这就是水平越权。</p>
<p>水平越权攻击可能使用与垂直越权类似的漏洞利用方法。例如，用户可能通常使用如下
URL 访问他们自己的帐户页面：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://insecure-website.com/myaccount?id=123</span><br></pre></td></tr></table></figure>
<p>现在，如果攻击者将 <code>id</code>
参数值修改为另一个用户的值，则攻击者可能会访问另一个用户的帐户页面，以及相关数据和功能。</p>
<p>靶场 1：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter">Lab:
User ID controlled by request parameter | Web Security Academy</a></p>
<p>在某些应用程序中，可利用参数没有可预测的值。例如，应用程序可以使用全局唯一标识符
(GUID)
来标识用户，而不是递增的数字。在这里，攻击者可能无法猜测或预测另一个用户的标识符。但是，属于其他用户的
GUID 可能会在引用用户的应用程序的其他地方公开，例如用户消息或评论。</p>
<p>靶场 2：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids">Lab:
User ID controlled by request parameter, with unpredictable user IDs |
Web Security Academy</a></p>
<p>在某些情况下，应用程序会检测到何时不允许用户访问资源，并返回到登录页面的重定向。但是，包含重定向的响应可能仍包含一些属于目标用户的敏感数据，因此攻击仍然成功。</p>
<p>靶场 3：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect">Lab:
User ID controlled by request parameter with data leakage in redirect |
Web Security Academy</a></p>
<h2 id="从水平越权到垂直越权">2.3. 从水平越权到垂直越权</h2>
<p>通常，通过危及更高特权的用户，水平越权攻击可以变成垂直越权。例如，水平越权可能允许攻击者重置或捕获属于另一个用户的密码。如果攻击者以管理用户为目标并破坏了他们的帐户，那么他们可以获得管理访问权限，从而执行垂直越权。</p>
<p>例如，攻击者可能能够使用已经针对水平越权描述的参数篡改技术来访问另一个用户的帐户页面：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://insecure-website.com/myaccount?id=456</span><br></pre></td></tr></table></figure>
<p>如果目标用户是应用程序管理员，那么攻击者将获得对管理帐户页面的访问权限。此页面可能会泄露管理员密码或提供更改密码的方法，或者可能提供对特权功能的直接访问。</p>
<p>靶场 1：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-password-disclosure">Lab:
User ID controlled by request parameter with password disclosure | Web
Security Academy</a></p>
<h2 id="不安全的直接对象引用">2.4. 不安全的直接对象引用</h2>
<p>不安全的直接对象引用 (Insecure direct object references, IDOR)
是访问控制漏洞的一个子类别。当应用程序使用用户提供的输入直接访问对象并且攻击者可以修改输入以获得未经授权的访问时，就会出现
IDOR。它因出现在 OWASP 2007
前十名而广受欢迎，尽管它只是许多可能导致访问控制被规避的实施错误的一个例子。</p>
<h3 id="直接引用数据库对象的-idor-漏洞">2.4.1. 直接引用数据库对象的 IDOR
漏洞</h3>
<p>考虑一个网站，它使用以下 URL
通过从后端数据库检索信息来访问客户帐户页面：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://insecure-website.com/customer_account?customer_number=132355</span><br></pre></td></tr></table></figure>
<p>在这里，客户编号直接用作对后端数据库执行的查询中的记录索引。如果没有其他控制措施，攻击者可以简单地修改
<code>customer_number</code>
值，绕过访问控制来查看其他客户的记录。这是导致水平越权的 IDOR
漏洞示例。</p>
<h3 id="直接引用静态文件的-idor-漏洞">2.4.2. 直接引用静态文件的 IDOR
漏洞</h3>
<p>当敏感资源位于服务器端文件系统的静态文件中时，通常会出现 IDOR
漏洞。例如，网站可能会使用递增的文件名将聊天消息记录保存到磁盘，并允许用户通过访问如下
URL 来检索这些内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://insecure-website.com/static/12144.txt</span><br></pre></td></tr></table></figure>
<p>在这种情况下，攻击者可以简单地修改文件名来检索另一个用户创建的副本，并可能获取用户凭据和其他敏感数据。</p>
<p>靶场 1：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-insecure-direct-object-references">Lab:
Insecure direct object references | Web Security Academy</a></p>
<h2 id="多步骤流程中的访问控制漏洞">2.5. 多步骤流程中的访问控制漏洞</h2>
<p>许多网站通过一系列步骤实现重要功能。当需要捕获各种输入或选项时，或者当用户需要在执行操作之前查看和确认详细信息时，通常会执行此操作。例如，更新用户详细信息的管理功能可能涉及以下步骤：</p>
<ol type="1">
<li>加载包含特定用户详细信息的表单；</li>
<li>提交修改；</li>
<li>查看更改并确认；</li>
</ol>
<p>有时，网站会对其中一些步骤实施严格的访问控制，而忽略其他步骤。例如，假设访问控制正确应用于第一步和第二步，但没有应用于第三步。实际上，该网站假定用户只有在已经完成第一步的情况下才会到达第
3
步，这些步骤受到适当控制。在这里，攻击者可以通过跳过前两步，直接提交带有所需参数的第三步请求，获得对该功能的未授权访问。</p>
<p>靶场 1：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-multi-step-process-with-no-access-control-on-one-step">Lab:
Multi-step process with no access control on one step | Web Security
Academy</a></p>
<h2 id="基于-referer-的访问控制">2.6. 基于 Referer 的访问控制</h2>
<p>一些网站基于 HTTP 请求中提交的 Referer 标头进行访问控制。 Referer
header 一般是浏览器在请求中添加的，用来表示发起请求的页面。</p>
<p>例如，假设一个应用程序对位于 <code>/admin</code>
的管理页面实施了严格访问控制，但对于<code>/admin/deleteUser</code>
等子页面仅检查 Referer 标头。如果 Referer 标头包含主<code>/admin</code>
URL，则允许该请求。</p>
<p>在这种情况下，由于 Referer
标头可以完全被攻击者控制，他们可以伪造对敏感子页面的直接请求，提供所需的
Referer 标头，从而获得未经授权的访问。</p>
<p>靶场 1：<a
target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/lab-referer-based-access-control">Lab:
Referer-based access control | Web Security Academy</a> ## 2.7.
基于位置的访问控制</p>
<p>一些网站根据用户的地理位置强制实施对资源的访问控制。例如，这可以适用于适用州立法或业务限制的银行应用程序或媒体服务。这些访问控制通常可以通过使用网络代理、VPN
或操纵客户端地理定位机制来规避。</p>
<h1 id="防御措施">3. 防御措施</h1>
<p>通常可以通过采取 <code>defense-in-depth</code>
方法并应用以下原则来防止访问控制漏洞：</p>
<ul>
<li>永远不要单独依赖混淆来进行访问控制
(把路径设置的很复杂就是混淆)。</li>
<li>除非资源旨在公开访问，否则默认情况下拒绝访问。</li>
<li>尽可能使用单一的应用程序范围的机制来实施访问控制。</li>
<li>在代码层面，强制要求开发人员声明每个资源允许的访问权限，默认情况下拒绝访问。</li>
<li>彻底审核和测试访问控制策略，以确保它们按设计工作。</li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>加载评论需要在浏览器启用 JavaScript 脚本支持。</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">1. 什么是访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1.1. 访问控制模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#programmatic-access-control"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1. Programmatic access
control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discretionary-access-controldac"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2. Discretionary access
control（DAC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mandatory-access-controlmac"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3. Mandatory access
control（MAC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#role-based-access-controlrbac"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.1.4. Role-based access
control（RBAC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#attribute-based-access-controlabac"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.1.5. Attribute-based
access control（ABAC）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.2.</span> <span class="toc-text">1.2. 垂直访问控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.3.</span> <span class="toc-text">1.3. 水平访问控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9B%B8%E5%85%B3%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.4.</span> <span class="toc-text">1.4. 上下文相关的访问控制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%B1%E6%95%88%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%BE%8B%E5%AD%90"><span class="toc-number">2.</span> <span class="toc-text">2. 失效的访问控制例子</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">2.1.</span> <span class="toc-text">2.1. 垂直越权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%8F%97%E4%BF%9D%E6%8A%A4%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1. 不受保护的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8F%82%E6%95%B0%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2. 基于参数的访问控制方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E5%8F%B0%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3.
平台配置错误导致访问控制失效</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url-%E5%8C%B9%E9%85%8D%E5%B7%AE%E5%BC%82%E5%AF%BC%E8%87%B4%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4. URL
匹配差异导致的访问控制失效</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83"><span class="toc-number">2.2.</span> <span class="toc-text">2.2. 水平越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83%E5%88%B0%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">2.3.</span> <span class="toc-text">2.3. 从水平越权到垂直越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%B4%E6%8E%A5%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8"><span class="toc-number">2.4.</span> <span class="toc-text">2.4. 不安全的直接对象引用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E5%BC%95%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1%E7%9A%84-idor-%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1. 直接引用数据库对象的 IDOR
漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E5%BC%95%E7%94%A8%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E7%9A%84-idor-%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2. 直接引用静态文件的 IDOR
漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E6%AD%A5%E9%AA%A4%E6%B5%81%E7%A8%8B%E4%B8%AD%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.5.</span> <span class="toc-text">2.5. 多步骤流程中的访问控制漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-referer-%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">2.6.</span> <span class="toc-text">2.6. 基于 Referer 的访问控制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD"><span class="toc-number">3.</span> <span class="toc-text">3. 防御措施</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&text=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&title=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&is_video=false&description=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Access_control_vulnerabilities_and_privilege_escalation&body=Check out this article: https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&title=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&title=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&title=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&title=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&name=Access_control_vulnerabilities_and_privilege_escalation&description=&lt;p&gt;网站：&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;a href=&#34;https://portswigger.net/web-security/access-control&#34;&gt;Access
control vulnerabilities and privilege escalation | Web Security
Academy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a
href=&#34;https://portswigger.net/web-security/all-labs#access-control-vulnerabilities&#34;&gt;All
labs | Web Security Academy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a
href=&#34;../../基础知识/OWASP_Top_10_2021.md&#34;&gt;OWASP_Top_10_2021&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a
href=&#34;https://portswigger.net/web-security/access-control/security-models&#34;&gt;Access
control security models | Web Security Academy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a
href=&#34;https://portswigger.net/web-security/access-control/idor&#34;&gt;Insecure
direct object references (IDOR) | Web Security Academy&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://hdfzzf.github.io/2023/04/21/Access_control_vulnerabilities_and_privilege_escalation/&t=Access_control_vulnerabilities_and_privilege_escalation"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021-2023
    hdfzzf
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'cactus-1';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
